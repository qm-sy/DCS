C51 COMPILER V9.60.7.0   KEY                                                               12/29/2025 16:19:13 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE KEY
OBJECT MODULE PLACED IN ..\Output\key.obj
COMPILER INVOKED BY: D:\APP\KEIL\MDK\C51\BIN\C51.EXE ..\BSP\Src\key.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(..\Driver;..
                    -\SYSTEM\Inc;..\BSP\Inc;..\Core\Inc;..\Emembed\Inc) DEBUG OBJECTEXTEND PRINT(.\Listings\key.lst) TABS(2) OBJECT(..\Output
                    -\key.obj)

line level    source

   1          #include "key.h"
   2          
   3          KEY key;
   4          
   5          volatile uint8_t key_value = 0;
   6          
   7          /*
   8              key1        key6
   9              key2        key5
  10              key3        key4
  11          */
  12          void key_scan( void )
  13          {
  14   1          uint8_t key_continue_cnt = 100;
  15   1      
  16   1          if( key.key_read_allow == 1 )
  17   1          {
  18   2              switch (key_value)
  19   2              {
  20   3                  case PowerKey:                                      //key6  Áü≠Êåâ-ÂºÄ     ÈïøÊåâ-ÂÖ≥
  21   3                      while((key_value == PowerKey) && (key_continue_cnt > 0))
  22   3                      {
  23   4                          key_continue_cnt--;
  24   4                          delay_ms(10);
  25   4                      }
  26   3      
  27   3                      if( key_continue_cnt == 0 )
  28   3                      {
  29   4                          Power_Ctrl(POWER_OFF);
  30   4                      }else
  31   3                      {
  32   4                          Power_Ctrl(POWER_ON);
  33   4                      }
  34   3      
  35   3                      break;
  36   3      
  37   3                  case Channel:                                       //key1  Áü≠Êåâ-ÈÄöÈÅìÈÄâÊã©   ÈïøÊåâ-Ê∏©Â∫
             -¶ËÆæÁΩÆ
  38   3                      while((key_value == Channel) && (key_continue_cnt > 0))
  39   3                      {
  40   4                          key_continue_cnt--;
  41   4                          delay_ms(10);
  42   4                      }
  43   3                      if( key_continue_cnt == 0 )
  44   3                      {
  45   4                          alarm_temp_set();
  46   4                      }else
  47   3                      {
  48   4                          channel_ctrl();
  49   4                      }
  50   3      
  51   3                      break;
  52   3                      
C51 COMPILER V9.60.7.0   KEY                                                               12/29/2025 16:19:13 PAGE 2   

  53   3                  case Mode:                                          //key2  Áü≠Êåâ-ÂàáÊç¢Ê®°Âºè     ÈïøÊåâ-Âêå
             -Ê≠•ÂºÄ/ÂÖ≥
  54   3                      while((key_value == Mode) && (key_continue_cnt > 0))
  55   3                      {
  56   4                          key_continue_cnt--;
  57   4                          delay_ms(10);
  58   4                      }
  59   3                      if( key_continue_cnt == 0 )
  60   3                      {
  61   4                          sync_ctrl();
  62   4                      }else
  63   3                      {
  64   4                          mode_ctrl();
  65   4                      }
  66   3      
  67   3                      break;
  68   3      
  69   3                  case Num_Up:    power_temp_set(Num_Up);     break;  //key5          Ê∏©Â∫¶/ÂäüÁéá ++
  70   3                      
  71   3                  case Num_Down:  power_temp_set(Num_Down);   break;  //key4          Ê∏©Â∫¶/ÂäüÁéá --
  72   3      
  73   3                  case FanUp:     fan_level_ctrl(FanUp);      break;  //key3 + key5   È£éÈÄü++
  74   3                      
  75   3                  case FanDown:   fan_level_ctrl(FanDown);    break;  //key3 + key4   È£éÈÄü--
  76   3      
  77   3                  default:                                    break;
  78   3              }
  79   2              key.key_read_allow = 0;
  80   2          }
  81   1      }
  82          
  83          void Power_Ctrl( uint8_t power_switch )
  84          {
  85   1          if( power_switch == POWER_ON )
  86   1          {
  87   2              led_status_ctrl(LED_OPEN);
  88   2              lcd_info.Power_Swtich = 1;
  89   2              write_slave_06(0x06,0x00,lcd_info.Power_Swtich);
  90   2          }else
  91   1          {
  92   2              led_status_ctrl(LED_SLEEP);
  93   2              lcd_info.Power_Swtich = 0;
  94   2              write_slave_06(0x06,0x00,lcd_info.Power_Swtich);
  95   2              delay_ms(1000);                             //ÈÅøÂÖçËØØËß¶ÂÜçÊ¨°ÂºÄÂêØ
  96   2          }
  97   1      }
  98          
  99          void power_temp_set( uint8_t key_val )
 100          {
 101   1          if( key_val == Num_Up )
 102   1          {
 103   2              if( lcd_info.power_level < 100 )
 104   2              {
 105   3                  lcd_info.power_level += 5;
 106   3              }
 107   2          }
 108   1          if( key_val == Num_Down )
 109   1          {
 110   2              if( lcd_info.power_level > 0 )
 111   2              {
 112   3                  lcd_info.power_level -= 5;
 113   3              }
C51 COMPILER V9.60.7.0   KEY                                                               12/29/2025 16:19:13 PAGE 3   

 114   2          }
 115   1          num_dis(lcd_info.power_level);
 116   1          write_slave_06(0x03,0x00,lcd_info.power_level);
 117   1      }
 118          
 119          void fan_level_ctrl( uint8_t key_val )
 120          {
 121   1          if( key_val == FanUp )
 122   1          {
 123   2              if( lcd_info.fan_level < 6 )
 124   2              {
 125   3                  lcd_info.fan_level++;
 126   3              }
 127   2          }
 128   1      
 129   1          if( key_val == FanDown )
 130   1          {
 131   2              if( lcd_info.fan_level > 0 )
 132   2              {
 133   3                  lcd_info.fan_level--;
 134   3              }    
 135   2          }
 136   1      
 137   1          wind_dis(lcd_info.fan_level);
 138   1          write_slave_06(0x02,0x00,lcd_info.fan_level);
 139   1      }
 140          
 141          void channel_ctrl( void )
 142          {
 143   1          if(lcd_info.channel_num == 7)
 144   1          {
 145   2              lcd_info.channel_num = 1;
 146   2          }else
 147   1          {
 148   2              lcd_info.channel_num += 1;
 149   2          }
 150   1          channel_dis(lcd_info.channel_num);
 151   1          write_slave_06(0x00,0x00,lcd_info.channel_num);
 152   1      }
 153          
 154          void mode_ctrl( void )
 155          {
 156   1          if( lcd_info.mode_num == 5 )
 157   1          {
 158   2              lcd_info.mode_num = 1;
 159   2          }else
 160   1          {
 161   2              lcd_info.mode_num += 1;
 162   2          }
 163   1      
 164   1          screen_clear();                 //‰∏ÄÊ¨°Ê∏ÖÂ±è
 165   1          mode_dis(DIS_ON);               //ÊòæÁ§∫Ê®°ÂºèÂ∫èÂè∑ÂíåÊ†áÂøó
 166   1          num_dis(lcd_info.mode_num);     
 167   1          delay_ms(500);
 168   1          screen_clear();
 169   1          write_slave_06(0x05,0x00,lcd_info.mode_num);
 170   1      }
 171          
 172          void alarm_temp_set( void )
 173          {
 174   1          screen_clear();
 175   1          delay_ms(1000);
C51 COMPILER V9.60.7.0   KEY                                                               12/29/2025 16:19:13 PAGE 4   

 176   1          while(key_value != Channel)
 177   1          {
 178   2              Celsius_dis(DIS_ON);
 179   2              if( lcd_info.alarm_temp_flick_flag == 1 )
 180   2              {
 181   3                  num_dis(lcd_info.OTP_temp1);
 182   3              }else
 183   2              {
 184   3                  screen_write_val(addr_tab[ADDR_0B],0x00);
 185   3                  screen_write_val(addr_tab[ADDR_0A],0X00);
 186   3                  screen_write_val(addr_tab[ADDR_07],0X00);
 187   3                  screen_write_val(addr_tab[ADDR_06],0X00);
 188   3              }
 189   2      
 190   2              if( key_value == Num_Up )
 191   2              {
 192   3                  if( lcd_info.OTP_temp1 < 120 )
 193   3                  {
 194   4                      lcd_info.OTP_temp1 += 1;
 195   4                      write_slave_06(0x04,0x00,lcd_info.OTP_temp1);
 196   4                      delay_ms(300);
 197   4                  }
 198   3              }
 199   2      
 200   2              if( key_value == Num_Down )
 201   2              {
 202   3                  if( lcd_info.OTP_temp1 > 40 )
 203   3                  {
 204   4                      lcd_info.OTP_temp1 -= 1;
 205   4                      write_slave_06(0x04,0x00,lcd_info.OTP_temp1);
 206   4                      delay_ms(300);
 207   4                  }
 208   3              }
 209   2          }
 210   1          
 211   1          screen_all_dis();
 212   1          delay_ms(500);
 213   1      }
 214          
 215          void sync_ctrl( void )
 216          {
 217   1          lcd_info.sync_switch = 1 - lcd_info.sync_switch;
 218   1          sync_dis(lcd_info.sync_switch);
 219   1          write_slave_06(0x01,0x00,lcd_info.sync_switch);
 220   1          delay_ms(1000);
 221   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    672    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      2       1
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
